\documentclass[a4paper,10pt,twoside]{article}

\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[spanish,es-ucroman,es-noquoting]{babel}
\usepackage{setspace}
\usepackage{xspace}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{float}
\usepackage{algpseudocode}
\usepackage{enumitem} % Provee macro \setlist
\usepackage[toc, page]{appendix}


%%%%%%%%%% Configuración de Fancyhdr - Inicio %%%%%%%%%%
\pagestyle{fancy}
\thispagestyle{fancy}
\lhead{Trabajo Práctico 3 · Sistemas Operativos}
\rhead{Delgado · Lovisolo · Petaccio}
\renewcommand{\footrulewidth}{0.4pt}
\cfoot{\thepage /\pageref{LastPage}}

\fancypagestyle{caratula} {
   \fancyhf{}
   \cfoot{\thepage /\pageref{LastPage}}
   \renewcommand{\headrulewidth}{0pt}
   \renewcommand{\footrulewidth}{0pt}
}
%%%%%%%%%% Configuración de Fancyhdr - Fin %%%%%%%%%%


%%%%%%%%%% Configuración de Algorithmic - Inicio %%%%%%%%%%
% Entorno propio para customizar la presentación del pseudocódigo
\newenvironment{pseudo}[1][]{%
    \vspace{0.5em}%
    \begin{algorithmic}%
}
{%
    \end{algorithmic}%
    \vspace{0.5em}%
}

% Llamada a función para usar así: \Fn{Foo}{bar, baz}.
% Produce \textsc{Foo}$(bar, baz)$.
\newcommand{\Fn}[2]{\textsc{#1}$(#2)$}

% Cláusula return para usar así: \PReturn foo
\newcommand{\PReturn}[1]{\textbf{return} $#1$}

% Cláusula break
\newcommand{\Break}{\textbf{break}}

% Operadores lógicos
\newcommand{\PAnd}{\textbf{and} }
\newcommand{\POr}{\textbf{or} }
\newcommand{\PNot}{\textbf{not} }

% Booleanos
\newcommand{\PTrue}{\textnormal{TRUE} }
\newcommand{\PFalse}{\textnormal{FALSE} }

% Null
\newcommand{\Null}{\textnormal{NULL} }

% Conectivo 'in' para usar así: \ForAll{$foo$ \In $bar$}
\newcommand{\In}{\textbf{in} }

% Conectivo 'to' para usar así: \For{$i = 1$ \In $n$}
\newcommand{\To}{\textbf{to} }

% Complejidades
\newcommand{\Ode}[1]{\hfill $O(#1)$}
%%%%%%%%%% Configuración de Algorithmic - Fin %%%%%%%%%%


%%%%%%%%%% Configuración de Appendix - Inicio %%%%%%%%%%
% Asigna la traducción de la palabra 'Appendices'.
\renewcommand{\appendixtocname}{Apéndices}
\renewcommand{\appendixpagename}{Apéndices}
%%%%%%%%%% Configuración de Appendix - Fin %%%%%%%%%%


%%%%%%%%%% Miscelánea - Inicio %%%%%%%%%%
% Evita que el documento se estire verticalmente para ocupar el espacio vacío
% en cada página.
\raggedbottom

% Deshabilita sangría en la primer línea de un párrafo.
\setlength{\parindent}{0em}

% Separación entre párrafos.
\setlength{\parskip}{0.5em}

% Separación entre elementos de listas.
\setlist{itemsep=0.5em}
%%%%%%%%%% Miscelánea - Fin %%%%%%%%%%


%%%%%%%%%% Macros para el análisis de las consultas - Inicio %%%%%%%%%%
\newcommand{\map}{\emph{map}\xspace}
\newcommand{\reduce}{\emph{reduce}\xspace}
%%%%%%%%%% Macros para el análisis de las consultas - Fin %%%%%%%%%%


\begin{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Carátula                                                                  %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\thispagestyle{caratula}

\begin{center}

\includegraphics[height=2cm]{DC.png} 
\hfill
\includegraphics[height=2cm]{UBA.jpg} 

\vspace{2cm}

Departamento de Computación,\\
Facultad de Ciencias Exactas y Naturales,\\
Universidad de Buenos Aires

\vspace{4cm}

\begin{Huge}
Trabajo Práctico 3
\end{Huge}

\vspace{0.5cm}

\begin{Large}
Sistemas Operativos
\end{Large}

\vspace{1cm}

Segundo Cuatrimestre de 2013

\vspace{4cm}

\begin{tabular}{|c|c|c|}
\hline
Apellido y Nombre & LU & E-mail\\
\hline
Alejandro Nahuel Delgado & 601/11 & nahueldelgado@gmail.com\\
Leandro Lovisolo         & 645/11 & leandro@leandro.me\\
Lautaro José Petaccio    & 443/11 & lausuper@gmail.com\\
\hline
\end{tabular}

\end{center}

\newpage


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Índice                                                                    %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\tableofcontents

\newpage


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Análisis del cuerpo de datos                                              %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Análisis del cuerpo de datos}


\subsection{¿Es la comunidad en promedio más \emph{upvoter} o más \emph{downvoter}?}

En el paso \map se emite una misma key para cada submission, asociada a una estructura con los siguientes campos:

\begin{description}
	\item[upvotes:] Cantidad de votos positivos.
	\item[total\_upvotes:] Cantidad total de votos.
	\item[positivity:] Campo usado en el paso \reduce. Entero con valor 0.
\end{description}

En el paso \reduce se acumula la suma de todos los votos positivos en el campo \textbf{upvotes}, se acumula el total de los votos en el campo \textbf{total\_upvotes} y se calcula el porcentaje de votos positivos en el campo \textbf{positivity}, de acuerdo a la fórmula

$$\textbf{positivity} = \frac{\textbf{upvotes} \times 100}{\textbf{total\_upvotes}}.$$

La comunidad se determina más \emph{upvoter} si $\textbf{positivity} > 50$, o \emph{downvoter} en caso contrario.


\subsection{Promedio de comentarios por submission}

En el paso \map se emite una misma key para cada submission, asociada a una estructura con los siguientes campos:

\begin{description}
	\item[comments:] Cantidad de comentarios de la submission.
	\item[submissions:] Campo usado en el paso \reduce para acumular la cantidad de submissions en el cuerpo de datos. Entero con valor 1.
	\item[avgComments:] Campo usado en el paso \reduce para calcular el promedo de comentarios por submission. Entero con valor 0.
\end{description}

En el paso \reduce se acumula el total de comentarios en el campo \textbf{comments}, se acumula el total de submissions en el campo \textbf{submissions} y se calcula el promedio de comentarios por submission en el campo \textbf{avgComments}, de acuerdo a la fórmula

$$\textbf{avgComments} = \frac{\textbf{comments}}{\textbf{submissions}}.$$

El promedio de comentarios por submission en la comunidad es entonces el valor del campo \textbf{avgComments}.


\subsection{El usuario con la suma (score) más alta de todos.}

Esta consulta devuelve el usuario tal que la suma del campo \textbf{score} de todas las submissions cuyo autor sea dicho usuario es máxima.

Se divide la consulta en dos pares de operaciones \map/\reduce.

En el primer \map se emite una key cuyo valor es el autor de la submission, asociada a una estructura con los siguientes campos:

\begin{description}
	\item[username:] El autor de la submission.
	\item[score:] El score de la submission.
\end{description}

Si el usuario de la submission es nulo, la función \map termina sin emitir ningún valor.

En el primer \reduce se acumula el score total de las submissions del usuario correspondiente a cada key bajo el campo \textbf{score}.

Luego del primer \map/\reduce se obtiene una colección con campos \textbf{username} y \textbf{score}, que para cada usuario nos indica la suma de los scores de todas las submissions cuyo autor es ese usuario.

El segundo \map agrupa bajo un mismo key todas las entradas de la colección obtenida en el \map/\reduce anterior, dejando los campos \textbf{username} y \textbf{score} intactos.

El segundo \reduce busca la entrada con máximo score y devuelve esa entrada sin modificarla.

El resultado del segundo \map/\reduce es una estructura con campos \textbf{username} y \textbf{score} que indica el usuario con la máxima suma de scores de submissions y el valor de dicha suma.


\subsection{Subreddit más popular}

Esta consulta devuelve el subreddit con el mayor número de comentarios; es decir, el subreddit tal que la suma de los comentarios de todas las submissions dentro de ese subreddit es máxima.

En el primer \map se emite una key cuyo valor es el subreddit de la submission, asociada a una estructura con los siguientes campos:

\begin{description}
	\item[subreddit:] El subreddit de la submission.
	\item[number\_of\_comments:] El número de comentarios de la submission.
\end{description}

En el primer \reduce se acumula el total de comentarios de las submissions en el subreddit correspondiente a cada key bajo el campo \textbf{number\_of\_comments}.

Luego del primer \map/\reduce se obtiene una colección con campos \textbf{subreddit} y \textbf{number\_of\_comments}, que para cada subreddit nos indica la suma del número de comentarios de todas las submissions dentro de ese subreddit.

El segundo \map agrupa bajo un mismo key todas las entradas de la colección obtenida en el \map/\reduce anterior, dejando los campos \textbf{subreddit} y \textbf{number\_of\_comments} intactos.

El segundo \reduce busca la entrada con máximo número de comentarios y devuelve esa entrada sin modificarla.

El resultado del segundo \map/\reduce es una estructura con campos \textbf{subreddit} y \textbf{number\_of\_comments} que indica el subreddit con la máxima cantidad de comentarios realizados en submissions dentro de ese subreddit y el valor de dicha suma.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Análisis de escalabilidad                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Análisis de escalabilidad}


\subsection{Definición de \emph{Cloud Computing}}


\subsection{Alternativas de \emph{IaaS} y \emph{PaaS}}


\subsection{De la nube al hardware propio}


\end{document}